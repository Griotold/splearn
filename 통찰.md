# 강의를 들으면서 얻은 통찰

## 섹션 3. 도메일 모델이 이끄는 개발

### Member 엔티티 생성
- 테스트 코드는 도메인 규칙을 잘 지키는지를 검증해야 한다.

### Member 도메인 로직 개발
- 도메인 모델에 규칙을 상세히 적어두고, 테스트 코드는 그 규칙을 고대로 옮겨 놓는 것이다. 
  - `@DisplayName`은 필요할 때만 넣는다.
- 엔티티에 `org.springframework.util.Assert`를 적극적으로 사용하자.
- 하나의 테스트 코드에서 검증 하는 부분이 2개여도 괜찮다.

### 스프링을 이용한 `null`안전성 확보
- `SpotBugs` 플러그인을 활용해서 `null` 안전성을 확보하자.
- `JSR-305`, `@NonNull`, `@Nullable`

### Member 도메인 모델 확장
- 도메인 모델에서 패스워드 암호화를 해야한다.
- 정적 팩토리 메서드
- Test Fixture

### Member 도메인 코드 개선
- 파라미터가 길어질 때 해결 방법 -> 파라미터 오브젝트

### 도메인 모델 값 객체(Value Object) 도입
- 이메일은 유효성 검사가 필요하고, 매번 검사를 해줘야하니 값 객체로 만들어보자.
- 값 객체는 도메인 모델에서 식별자가 필요하지 않고 속성/값으로 만 구별되는 오브젝트이다.
  - 따라서, 동등성(equals, hashCode)을 보장해줘야 한다.
- 엔티티가 너무 많은 책임을 지는 것을 막는다.
- 변경이 필요하면 값 객체 자체를 변경해버린다.
- 풍부한 기능
- 자체 유효성 검사

## 섹션 4. 헥사고날 아키텍쳐

### 헥사고날 아키텍처의 사실과 오해(1, 2)
- 서비스 계층에서 인터페이스는 꼭 만들자.
- 헥사고날 아키텍쳐는 스프링의 핵심 원리를 잘 따르는 아키텍쳐다.
- 헥사고날 아키텍쳐는 사실 테스트를 위한 아키텍쳐였다.
  - 출발이 그렇다.
  - 따라서, 테스트를 안 만들면 헥사고날 아키텍쳐의 의미가...
- 헥사고날 아키텍쳐는 애플리케이션 내부 구현에 대한 원칙이나 요구사항이 없다.
  - 도메인 계층을 따로 두지 않아도 되고,
  - 트랜잭션 스크립트로 구현해도 되고,
  - 스파게티로 구현해도 무방하다.
- 코드 의존성은 내부로만 
  - [어댑터] -> [애플리케이션(포트 포함)] -> [도메인]
  - ![이미지](https://github.com/user-attachments/assets/1f2146fe-2aa2-4e5d-8be9-798d4b4513b4)

### 회원 애플리케이션의 포트 정의
- 인터페이스 명명 규칙: 자바에서는 명사 또는 형용사를 쓴다.
  - 명사: `List`, `Set`, `Map`, `Executor
  - 형용사: `Serializable`, `Comparable`, `iterable`

### 엔티티 식별자와 JPA 엔티티
- `MemberFixture`
```
package tobyspring.splearn.domain;

public class MemberFixture {

    public static PasswordEncoder createPasswordEncoder() {
        return new PasswordEncoder() {
            @Override
            public String encode(String password) {
                return password.toUpperCase();
            }

            @Override
            public boolean matches(String password, String passwordHash) {
                return encode(password).equals(passwordHash);
            }
        };
    }

    public static MemberRegisterRequest createMemberRegisterRequest(String email) {
        return new MemberRegisterRequest(email, "rio", "secret");
    }

    public static MemberRegisterRequest createMemberRegisterRequest() {
        return createMemberRegisterRequest("rio@splearn.app");
    }
}
```